<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Tetromino 2K</title><style>canvas{background:#111}</style><body>
Tetromino 2K | A Tetris clone in 2KB. | v1.0.4  <a href="https://landonjsmith.com/">Home</a><br>
<canvas id=c width=280 height=504></canvas>
<div id=i></div><div id=g></div><script>
let x=c.getContext("2d"),R=18,C=10,B=28,b=Array.from({length:R},()=>Array(C).fill(0)),s=[[[1,1,1],[0,1,0]],[[1,1],[1,1]],[[0,1,1],[1,1,0]],[[1,1,0],[0,1,1]],[[1,1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]]],o=["#000","#f00","#0f0","#00f","#ff0","#f0f","#0ff","#fff"],u={x:0,y:0,shape:[],c:0},n={},clr=[],sc=0,lv=1,ln=0,G=0,P=0,la=0,dr=500;function rnd(){let t=~~(Math.random()*s.length);return{x:3,y:0,shape:s[t],c:t+1}}function v(X,Y,S){return S.every((r,dy)=>r.every((c,dx)=>!c||(X+dx>=0&&X+dx<C&&Y+dy>=0&&Y+dy<R&&!b[Y+dy][X+dx])))}function m(){u.shape.forEach((r,dy)=>r.forEach((c,dx)=>{if(c)b[u.y+dy][u.x+dx]=u.c}))}function cl(){for(let y=R-1;y>=0;y--)if(b[y].every(c=>c)){clr.push({row:y,step:0});sc+=100;ln++;if(sc%500==0)lv++;}}function ac(){for(let j=clr.length-1;j>=0;j--){let l=clr[j];if(l.step<C){b[l.row][l.step]=0;l.step++}else{b.splice(l.row,1);b.unshift(Array(C).fill(0));clr.splice(j,1)}}}function rot(S){return S[0].map((_,I)=>S.map(r=>r[r.length-1-I]))}function dB(X,Y,c){x.fillStyle=o[c];x.fillRect(X*B+1,Y*B+1,B-2,B-2)}function draw(){x.clearRect(0,0,C*B,R*B);for(let y=0;y<R;y++)for(let X=0;X<C;X++)if(b[y][X])dB(X,y,b[y][X]);let gy=u.y;while(v(u.x,gy+1,u.shape))gy++;u.shape.forEach((r,dy)=>r.forEach((c,dx)=>{if(c){x.fillStyle="rgba(255,255,255,0.2)";x.fillRect((u.x+dx)*B+1,(gy+dy)*B+1,B-2,B-2);dB(u.x+dx,u.y+dy,u.c)}}));i.innerText="Score:"+sc+"\nLevel:"+lv+"\nLines:"+ln+(P?"\n[PAUSED]":"")+"\nNext:\n"+n.shape.map(r=>r.map(c=>c?'##':'..').join('')).join('\n');if(P){x.fillStyle="rgba(0,0,0,0.7)";x.fillRect(0,0,C*B,R*B);x.fillStyle="#fff";x.font="20px sans-serif";x.fillText("PAUSED",50,250)}}function spawn(){u=n;n=rnd();if(!v(u.x,u.y,u.shape))gameOver()}function gameOver(){G=1;g.innerHTML="GAME OVER\n<button onclick='restart()'>Restart</button>"}function restart(){b=Array.from({length:R},()=>Array(C).fill(0));sc=0;lv=1;ln=0;clr=[];G=0;P=0;la=0;n=rnd();spawn();loop();g.innerHTML="";}document.addEventListener("keydown",e=>{if(e.key==" "||e.key=="ArrowDown"||e.key=="ArrowUp")e.preventDefault();if(G)return;let k=e.key.toLowerCase();if(k=="p"||k=="escape"){P=!P;draw();return}if(P)return;if(k=="a"&&v(u.x-1,u.y,u.shape))u.x--;if(k=="d"&&v(u.x+1,u.y,u.shape))u.x++;if(k=="s"&&v(u.x,u.y+1,u.shape))u.y++;if(k=="w"){let r=rot(u.shape);if(v(u.x,u.y,r))u.shape=r}if(k==" "){while(v(u.x,u.y+1,u.shape))u.y++;m();cl();spawn()}});n=rnd();spawn();function loop(t){if(G||P){requestAnimationFrame(loop);return}if(t-la>dr-(lv*50)){if(v(u.x,u.y+1,u.shape))u.y++;else{m();cl();spawn()}la=t}ac();draw();requestAnimationFrame(loop)}loop();
</script>
